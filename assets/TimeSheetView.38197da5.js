import{_ as w,u as k,$ as o,o as h,c as a,a as m,n as C,F as p,t as f,r as D,d as _,e as j,p as x,b as T}from"./index.d936bd5b.js";function y(l,e){let s=[31,28,31,30,31,30,31,31,30,31,30,31];return S(e)&&l==2?29:s[l-1]}function S(l){return l%4==0&&l%100!=0||l%400==0}function v(l,e){let s=parseInt(l.split("/")[0]),c=parseInt(l.split("/")[1]),t=parseInt(l.split("/")[2]);for(s+=e;s>y(c,t);)s-=y(c,t),c++,c>12&&(c-=12,t++);return s<10&&c<10?"0"+s.toString()+"/0"+c.toString()+"/"+t.toString():s<10&&c>=10?"0"+s.toString()+"/"+c.toString()+"/"+t.toString():s>=10&&c<10?s.toString()+"/0"+c.toString()+"/"+t.toString():s.toString()+"/"+c.toString()+"/"+t.toString()}function B(l){return l=l.split("/"),l[1]+"/"+l[0]+"/"+l[2]}const O={name:"TimeSheetView",components:{},data(){return{userObj:k,projectID:this.$route.params.projectID,projectDict:k.projects[this.$route.params.projectID],weekID:"",selectedCellsList:[],dateList:[],timeList:[],colourList:[],columnLetter:[],weekDict:{},colourIDList:[],dayList:[],totalList:[],infoList:[],weekInterval:"",timeInterval:0,cellClicked:!1}},mounted(){this.colourIDList=[],this.colourIDList=Object.keys(k.colours);const l=e=>{o("#user_selection_tip").css({left:e.pageX+55+"px",top:e.pageY-20+"px"})};document.addEventListener("mousemove",l)},methods:{rightClickWeek(l){l.preventDefault();let e=o(l.target).position();o("#week_button_menu").removeClass("visible"),setTimeout(()=>{o("#week_button_menu").addClass("visible"),this.week=o(l.target).attr("data")},1),o("#week_button_menu").css({left:e.left+128.25+"px",top:e.top+5+"px"}),document.getElementById("app").addEventListener("click",c=>{c.target.offsetParent!=o("#week_button_menu")&&o("#week_button_menu").removeClass("visible")})},toggleCheckMark(){this.projectDict.weeks[this.week].invoiced?this.projectDict.weeks[this.week].invoiced=!1:this.projectDict.weeks[this.week].invoiced=!0},pickTextColorBasedOnBgColor(l){let e=l.charAt(0)==="#"?l.substring(1,7):l,s=parseInt(e.substring(0,2),16),c=parseInt(e.substring(2,4),16),t=parseInt(e.substring(4,6),16),r=[s/255,c/255,t/255].map(i=>i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4));return .2126*r[0]+.7152*r[1]+.0722*r[2]>.179?"#000000":"#ffffff"},addWeek(){let l=Object.keys(k.colours),e=this.projectDict.duration;if(this.projectDict.weekInterval==1){let s=this.projectDict.weeks[`${e}`].startDate;s=v(s,14),this.projectDict.weeks[`${e+1}`]={startDate:s,colouredCells:{},invoiced:!1,total:"0.00"},l.forEach(c=>{c!="colourWhite"&&(this.projectDict.weeks[`${e}`].colouredCells[c]=[])}),this.projectDict.duration+=1}else if(this.projectDict.weekInterval==2){let s=`${e-1} - ${e}`,c=this.projectDict.weeks[s].startDate;c=v(c,14),this.projectDict.weeks[`${e+1} - ${e+2}`]={startDate:c,colouredCells:{},invoiced:!1,total:"0.00"},l.forEach(t=>{t!="colourWhite"&&(this.projectDict.weeks[`${e+1} - ${e+2}`].colouredCells[t]=[])}),this.projectDict.duration+=2}},weekButton(l){this.weekID=o(l.target).attr("data"),o(".week_button").each((e,s)=>{o(s).removeClass("active_button")}),o(l.target).addClass("active_button"),this.loadTimeSheet()},loadTimeSheet(){this.weekDict=this.projectDict.weeks[this.weekID],this.dateList=["Time | Date"],this.dateList.push(this.weekDict.startDate);for(let e=1;e<this.projectDict.weekInterval*7;e++)this.dateList.push(v(this.weekDict.startDate,e));this.timeList=[...this.projectDict.timeList],this.colourList=[];for(let e of Object.keys(k.colours))e!="colourWhite"&&this.colourList.push(k.colours[e].name);this.colourList.push("Total Hours:"),this.colourList.push("Total Daily $:"),this.infoList=[],this.infoList.push("Weekly Hours:"),this.infoList.push("Weekly $:"),this.projectDict.weekInterval==1?this.columnLetter=["Z","A","B","C","D","E","F","G"]:this.columnLetter=["Z","A","B","C","D","E","F","G","H","I","J","K","L","M","N"];const l=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];this.dayList=["Day"],this.dateList.forEach(e=>{if(e!="Time | Date"){let s=new Date(B(e));this.dayList.push(l[s.getDay()])}}),this.totalList=["Timesheet Hours:"],this.totalList.push("Timesheet Total $:"),this.weekInterval=this.projectDict.weekInterval,this.timeInterval=this.projectDict.timeInterval,this.$nextTick(()=>{o(".timesheet_column").each(function(e,s){e==7&&(o(s).css("border-right","1px solid black"),o(s).css("margin-right","5px"))}),o(".cell").css({"background-color":"white","border-color":"black"});for(const e of Object.keys(this.weekDict.colouredCells))this.weekDict.colouredCells[e].forEach(s=>{o(`[cellid=${s}]`).css({"background-color":k.colours[e].colour,"border-color":"black"})});o(`.timesheet_column > div:nth-child(${this.projectDict.timeList.length+2})`).css("margin-bottom","7px"),o(`.timesheet_column > div:nth-child(${this.projectDict.timeList.length+2})`).css("border-bottom","1px solid black"),o(`.timesheet_column > div:nth-child(${this.timeList.length+this.colourList.length})`).css("margin-bottom","5px"),o(`.timesheet_column > div:nth-child(${this.timeList.length+this.colourList.length})`).css("border-bottom","1px solid black"),this.updateColourTotals()})},cellDown(l){this.cellClicked=!0;const e=o(l.target).attr("cellid");this.selectCell(l.target),this.selectedCellsList!=[]&&this.selectedCellsList.forEach(r=>{if(this.listOfValuesArr(this.weekDict.colouredCells).includes(r)){let i="";for(const[u,g]of Object.entries(this.weekDict.colouredCells))g.includes(r)&&(i=k.colours[u].colour);this.cellDeSelect(r,i)}else this.cellDeSelect(r,"white")}),this.selectedCellsList.includes(e)&&this.selectedCellsList.length==1?this.selectedCellsList=[]:this.selectedCellsList=[e];let s="Z"+e.substring(1),c=o(`[cellid=${s}]`).text().split(":"),t=this.selectedCellsList.length*Math.round(1/(60/this.projectDict.timeInterval)*1e3)/1e3,n=`${c[0]}:${c[1]} - ${c[0]}:${parseInt(c[1])+this.timeInterval-1}`;o("#user_selection_tip").text(`Time Selected: ${t.toFixed(2)}H
${n} `),o("#user_selection_tip").removeClass("hidden")},cellHovered(l){const e=o(l.target).attr("cellid");if(this.cellClicked&&!this.selectedCellsList.includes(e)){this.selectCell(l.target),this.selectedCellsList.push(e);let t=this.selectedCellsList.length*Math.round(1/(60/this.projectDict.timeInterval)*1e3)/1e3,n="Z"+this.minCell(this.selectedCellsList),r="Z"+this.maxCell(this.selectedCellsList),d=o(`[cellid=${r}]`).text().split(":"),i=`${o(`[cellid=${n}]`).text()} - ${d[0]}:${parseInt(d[1])+this.timeInterval-1}`;o("#user_selection_tip").text(`Time Selected: ${t.toFixed(2)}H
${i} `)}const s=e[0],c=e.substring(1);o(`[cellid=${s}-2]`).css({"background-color":"#D1D3D9"}),o(`[cellid=${s}-1]`).css({"background-color":"#D1D3D9"}),o(`[cellid=Z${c}]`).css({"background-color":"#D1D3D9"}),this.previousDate!=s&&(o(`[cellid=${this.previousDate}-2]`).css({"background-color":"#ffffff"}),o(`[cellid=${this.previousDate}-1]`).css({"background-color":"#ffffff"}),this.previousDate=s),this.previousTime!=c&&(this.previousTime===this.timeIndex?o(`[cellid=Z${this.previousTime}]`).css({"background-color":"#90ffde"}):o(`[cellid=Z${this.previousTime}]`).css({"background-color":"#ffffff"}),this.previousTime=parseInt(c))},cellRelease(){this.cellClicked=!1,o("#user_selection_tip").addClass("hidden"),localStorage.setItem("selectedCellsList",this.selectedCellsList)},selectCell(l){l.style.borderColor="cyan",l.style.background="#D1D3D9"},cellDeSelect(l,e){o(`[cellid=${l}]`).css({"background-color":e,"border-color":"black"})},listOfValues(l){let e=[];for(const[s,c]of Object.entries(l))e.push(c);return e},listOfValuesArr(l){let e=[];for(const[s,c]of Object.entries(l))for(const t of c)e.push(t);return e},minCell(l){let e=l[0].substring(1);for(let s=0;s<l.length;s++)parseInt(l[s].substring(1))<e&&(e=parseInt(l[s].substring(1)));return e},maxCell(l){let e=l[0].substring(1);for(let s=0;s<l.length;s++)parseInt(l[s].substring(1))>e&&(e=parseInt(l[s].substring(1)));return e},updateColourTotals(){let l=this.projectDict.timeList.length;for(const[d,i]of Object.entries(this.weekDict.colouredCells))if(d!="colourWhite"){let u={};this.projectDict.weekInterval==1?u={A:0,B:0,C:0,D:0,E:0,F:0,G:0}:u={A:0,B:0,C:0,D:0,E:0,F:0,G:0,H:0,I:0,J:0,K:0,L:0,M:0,N:0},i.forEach(g=>{u[g.charAt(0)]+=Math.round(1/(60/this.projectDict.timeInterval)*1e3)/1e3});for(let[g,L]of Object.entries(u))o(`[cellid=${g}${l}]`).text(`${L.toFixed(2)}`);l++}let e={};this.projectDict.weekInterval==1?e=["A","B","C","D","E","F","G"]:e=["A","B","C","D","E","F","G","H","I","J","K","L","M","N"];let s=0,c=0,t=0,n=0;for(let d=0;d<this.projectDict.weekInterval*7;d++){let i=this.projectDict.timeList.length,u=0,g=0;for(let L of Object.keys(k.colours))if(L!="colourWhite"){let b=`${e[d]}${i}`;u+=parseFloat(o(`[cellid=${b}]`).text()),g+=parseFloat(o(`[cellid=${b}]`).text())*k.colours[L].rate,i++}s+=u,c+=g,o(`[cellid=${e[d]}${i}]`).text(`${u}H`),o(`[cellid=${e[d]}${i+1}]`).text(`$${g.toFixed(2)}`),d%7==6&&(o(`[cellid=${e[d-6]}${i+2}]`).text(`${s}H`),o(`[cellid=${e[d-6]}${i+3}]`).text(`$${c.toFixed(2)}`),t+=s,n+=c,s=0,c=0)}this.weekDict.total=n.toFixed(2),o(`[cellid=A${l+4}]`).text(`${t.toFixed(2)}H`),o(`[cellid=A${l+5}]`).text(`$${n.toFixed(2)}`);let r=this.projectDict.targetHours-t<=0?0:this.projectDict.targetHours-t;o("#hours_left").text(r)},colourCell(l){let e=new Date,s=String(e.getDate()).padStart(2,"0"),c=String(e.getMonth()+1).padStart(2,"0"),t=e.getFullYear();e=c+"/"+s+"/"+t,e in k.timeLogged||(k.timeLogged={},k.timeLogged[e]={hours:0,pay:0});let n=0,r=k.timeLogged[e].pay;const d=o(l.target).attr("colourid");this.selectedCellsList.forEach(i=>{for(const u of Object.keys(k.colours))u!="colourWhite"&&this.weekDict.colouredCells[u].includes(i)&&(this.weekDict.colouredCells[u].splice(this.weekDict.colouredCells[u].indexOf(i),1),n-=Math.round(1/(60/this.projectDict.timeInterval)*1e3)/1e3,r-=k.colours[u].rate*Math.round(1/(60/this.projectDict.timeInterval)*1e3)/1e3);d!="colourWhite"&&this.weekDict.colouredCells[d].push(i),o(`[cellid=${i}]`).css({"background-color":k.colours[d].colour,"border-color":"black"})}),d!="colourWhite"&&(n+=this.selectedCellsList.length*Math.round(1/(60/this.projectDict.timeInterval)*1e3)/1e3,r+=n*k.colours[d].rate),k.timeLogged[e].hours=n+k.timeLogged[e].hours,k.timeLogged[e].pay=r,this.selectedCellsList=[],this.loadTimeSheet()}}},I=l=>(x("data-v-3f3b8af3"),l=l(),T(),l),$={class:"pageHome"},M={id:"container"},F=j(" Click on a week to get started! "),H={id:"time_Container"},W={id:"weeks_container"},A=["label","data"],E=["label","data"],Z=["colID"],N=["cellID"],V=["cellID"],G=["cellID"],K=["cellID"],P=["cellID"],J=["cellID"],Y=["cellID"],q=["cellID"],z=["cellID"],X=["cellID"],Q=["cellID"],R=["cellID"],U=I(()=>m("div",{id:"user_selection_tip",class:"tool_tip hidden"},"Time: ",-1)),ee={id:"colour_container"},te=["colourid"],le=I(()=>m("p",{style:{color:"#fff"}},"+",-1)),se=[le],ie={id:"week_button_menu"};function oe(l,e,s,c,t,n){return h(),a("div",$,[m("div",M,[m("div",{id:"top_title",style:C({background:`${t.projectDict.colour[0]}`,color:`${n.pickTextColorBasedOnBgColor(t.projectDict.colour[0])}`})},[t.weekID!==""?(h(),a(p,{key:0},[m("p",{style:C({color:`${n.pickTextColorBasedOnBgColor(t.projectDict.colour[0])}`})},"Complete ",4),m("p",{style:C([{color:`${n.pickTextColorBasedOnBgColor(t.projectDict.colour[0])}`},{"font-weight":"bold"}]),id:"hours_left"},null,4),m("p",{style:C({color:`${n.pickTextColorBasedOnBgColor(t.projectDict.colour[0])}`})},"more hours to reach "+f(t.projectDict.targetHours)+"H for "+f(t.projectDict.name),5)],64)):(h(),a(p,{key:1},[F],64))],4)]),m("div",H,[m("div",W,[(h(!0),a(p,null,D(t.projectDict.weeks,(r,d)=>(h(),a(p,{key:r},[r.invoiced==!0?(h(),a("div",{key:0,class:"week_button",label:d,onClick:e[0]||(e[0]=(...i)=>n.weekButton&&n.weekButton(...i)),data:d,style:{background:"radial-gradient(circle, #35a2ff 0%, #014a88 100%)",color:"white"},onContextmenu:e[1]||(e[1]=(...i)=>n.rightClickWeek&&n.rightClickWeek(...i))},f(d),41,A)):(h(),a("div",{key:1,class:"week_button",label:d,onClick:e[2]||(e[2]=(...i)=>n.weekButton&&n.weekButton(...i)),data:d,style:{background:"radial-gradient(circle, rgb(209 53 255) 0%, rgb(93 26 120) 100%)",color:"white"},onContextmenu:e[3]||(e[3]=(...i)=>n.rightClickWeek&&n.rightClickWeek(...i))},f(d),41,E))],64))),128)),m("div",{class:"week_button",color:"secondary",onClick:e[4]||(e[4]=(...r)=>n.addWeek&&n.addWeek(...r)),style:C({background:`radial-gradient(circle, ${t.projectDict.colour[1]} 0%, ${t.projectDict.colour[0]} 100%)`,color:`${n.pickTextColorBasedOnBgColor(t.projectDict.colour[1])}`})},"+",4)]),m("div",{id:"time_sheet_container",style:C({background:`${t.projectDict.colour[0]}`,color:`${n.pickTextColorBasedOnBgColor(t.projectDict.colour[0])}`})},[t.weekID!=""?(h(!0),a(p,{key:0},D(t.columnLetter,(r,d)=>(h(),a("div",{key:r,colID:r,class:"timesheet_column"},[m("div",{cellID:`${r}-2`,class:"dateCell"},f(t.dayList[d]),9,N),m("div",{cellID:`${r}-1`,class:"dateCell"},f(t.dateList[d]),9,V),r=="Z"?(h(!0),a(p,{key:0},D(t.timeList,(i,u)=>(h(),a("div",{key:i,cellID:`Z${u}`,class:"dateCell"},f(i),9,G))),128)):(h(!0),a(p,{key:1},D(t.timeList,(i,u)=>(h(),a("div",{key:i,cellID:`${r}${u}`,class:"cell",onMousedown:e[5]||(e[5]=(...g)=>n.cellDown&&n.cellDown(...g)),onMouseover:e[6]||(e[6]=(...g)=>n.cellHovered&&n.cellHovered(...g)),onMouseup:e[7]||(e[7]=(...g)=>n.cellRelease&&n.cellRelease(...g))},null,40,K))),128)),r=="Z"?(h(!0),a(p,{key:2},D(t.colourList,(i,u)=>(h(),a("div",{key:i,cellID:`Z${u+t.timeList.length}`,class:"dateCell"},f(i),9,P))),128)):(h(!0),a(p,{key:3},D(t.colourList,(i,u)=>(h(),a("div",{key:i,cellID:`${r}${u+t.timeList.length}`,class:"dateCell"},null,8,J))),128)),r=="Z"?(h(!0),a(p,{key:4},D(t.infoList,(i,u)=>(h(),a("div",{key:i,cellID:`Z${u+t.timeList.length+t.colourList.length}`,class:"dateCell"},f(i),9,Y))),128)):_("",!0),r=="A"?(h(!0),a(p,{key:5},D(t.infoList,(i,u)=>(h(),a("div",{key:i,cellID:`${r}${u+t.timeList.length+t.colourList.length}`,class:"infoCellA"},null,8,q))),128)):_("",!0),r=="H"?(h(!0),a(p,{key:6},D(t.infoList,(i,u)=>(h(),a("div",{key:i,cellID:`${r}${u+t.timeList.length+t.colourList.length}`,class:"infoCell"},null,8,z))),128)):_("",!0),r=="Z"?(h(!0),a(p,{key:7},D(t.totalList,(i,u)=>(h(),a("div",{key:i,cellID:`Z${u+t.timeList.length+t.colourList.length+2}`,class:"dateCell"},f(i),9,X))),128)):_("",!0),r=="A"&&t.weekInterval==1?(h(!0),a(p,{key:8},D(t.totalList,(i,u)=>(h(),a("div",{key:i,cellID:`${r}${u+t.timeList.length+t.colourList.length+2}`,class:"totalCellOne"},null,8,Q))),128)):_("",!0),r=="A"&&t.weekInterval==2?(h(!0),a(p,{key:9},D(t.totalList,(i,u)=>(h(),a("div",{key:i,cellID:`${r}${u+t.timeList.length+t.colourList.length+2}`,class:"totalCellTwo"},null,8,R))),128)):_("",!0)],8,Z))),128)):_("",!0),U],4),m("div",ee,[(h(!0),a(p,null,D(Object.keys(t.userObj.colours),r=>(h(),a("div",{key:r,colourid:r,class:"colour_item",style:C(`background-color:${t.userObj.colours[r].colour};`),onClick:e[8]||(e[8]=(...d)=>n.colourCell&&n.colourCell(...d))},[m("p",{style:C(`color: ${n.pickTextColorBasedOnBgColor(t.userObj.colours[r].colour)}`)},f(t.userObj.colours[r].name),5)],12,te))),128)),m("div",{class:"colour_item",style:{"background-color":"#000"},onClick:e[9]||(e[9]=r=>l.current_request_form="createColourForm")},se)]),m("div",ie,[m("div",{class:"context_option",onClick:e[10]||(e[10]=(...r)=>n.toggleCheckMark&&n.toggleCheckMark(...r))},"Toggle Invoice Status")])])])}var ce=w(O,[["render",oe],["__scopeId","data-v-3f3b8af3"]]);export{ce as default};
